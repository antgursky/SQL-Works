# HW_04 — база booking.*

## Задачи

1. (2 балла) Выведите для перелётов:
   - идентификатор перелёта  
   - аэропорт отправления  
   - аэропорт прибытия  
   - запланированные дата/время вылета  
   - актуальные дата/время вылета  
   - время задержки вылета  
   - минимальное, среднее и максимальное время задержки по аэропорту отправления  
   Условие: учитывать только перелёты, у которых есть актуальное время вылета и задержка ≥ 1 минута.

2. (2 балла) Выведите для пассажиров, бронировавших летом 2017 года:
   - имя и фамилия  
   - номер бронирования  
   - общая сумма бронирования  
   - номер билета и его стоимость  
   - количество билетов в бронировании  
   - минимальная и максимальная стоимость билета в бронировании  
   Отсортируйте по убыванию суммы брони и затем по количеству билетов.

3. (2 балла) Найдите **последний перелёт** для каждого пассажира с помощью группировок:  
   - имя и фамилия  
   - идентификатор полёта  
   - дата вылета (факт)  
   - аэропорт отправления (RU)  
   - аэропорт прибытия (RU)

4. (2 балла) Повторите задачу 3, но используйте оконные функции.

5. (2 балла) Постройте **маршрут перелётов** для пассажиров, у которых:  
   - имя начинается на «A» и содержит ещё одну букву «A»  
   - фамилия содержит «OV»  
   Выведите:
   - имя и фамилию раздельно  
   - предыдущий рейс (дата + аэропорт)  
   - текущий рейс (дата + аэропорт)  
   - следующий рейс (дата + аэропорт)  
